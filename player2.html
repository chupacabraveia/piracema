<!doctype html>
<html lang="pt">
  <head>
  <meta charset="UTF-8">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Streaming Player </title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integridade="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
<style>
video{
  width: 100vw;
  height: 100vh;
  object-fit: cover;
  position: fixed;
  top: 0;
  left: 0;
}

@media (min-width: 400px) {
  .column {
    width: 50%;
  }
}
</style>
<script src="hls.js"></script>
<script>
function msg_clear(){var msg = document.getElementById('messagem').innerHTML = '';var inpu = document.getElementById('link').value = '';document.getElementById('vvideo').style.display = "none";const hls = new Hls ();hls.stopLoad()}
function status_code(){
  const queryString = window.location.search;
  const urlParams = new URLSearchParams(queryString);
  var url = urlParams.get('link');
  if(url=='null') {url=document.getElementById('link').value;}
  console.log(url);
  var msg = document.getElementById('messagem');
  if (url.includes('.m3u8')==true){var xhr = new XMLHttpRequest();code = xhr.open('GET', url);xhr.onreadystatechange=function(){if(xhr.readyState==4){if (xhr.status == 200){document.getElementById('vvideo').style.display = "block";player_start(url)}else {msg.style.display="block";console.log(xhr.status)}}};xhr.send()}else{msg.innerHTML ='Link Inválido!';document.getElementById('link').value = '' ;console.log('link invalido')}}
function player_start(url) {
    document.getElementById('form').style.display='none';
    if (Hls.isSupported()) {status(url);const video = document.getElementById('video');const hls = new Hls ();hls.attachMedia(video);hls.on(Hls.Events.MEDIA_ATTACHED, function () {hls.loadSource(url);});}}
</script>


</head>
<body onload="status_code()">
	<div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
		<h1>Bdick.Play</h1>
		<div class="alert alert-danger" id="messagem" style="display:none" role="alert">
			<h3>Offline</h3>
		</div>
		<div id="vvideo" class=""  style="display:none">
			<video id="video" controls autoplay></video>
		</div>
		<div class="form-group" id="form">
			<label for="link" class="col-sm-2 col-form-label col-form-label-lg">Url</label>
			<div class="col-sm-10">
				<input type="url" name="text" class="form-control form-control-lg" id="link" placeholder="https://live.com/live/playlist.m3u8"onchange="status_code()" required>
			</div>
		</div>
		<button class="btn btn-success btn-block" onclick="status_code()">Play!</button>
		<button class="btn btn-danger btn-block" onclick="msg_clear()">Stop!</button>
   
  </div>
     <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integridade="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integridade="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin= "anônimo"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integridade="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/vendor/holder.min.js" integridade="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</body>
</html>
